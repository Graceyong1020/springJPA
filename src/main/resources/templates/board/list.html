<!DOCTYPE html>
<html xmlns:th="http://www/thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/basic.html}"
      lang="en">

<div layout:fragment="content">
    <div class="mt-3"></div>
    <form action="/board/list" method="get">
        <input type="hidden" name="size" th:value="${pageRequestDTO.size}">
        <div class="input-group">
        <div class="col-auto">
            <select class="form-control" name="type">
                <option value="">-------</option>
                <option value="t" th:selected="${pageRequestDTO.type=='t'}">Title</option>
                <option value="c" th:selected="${pageRequestDTO.type=='c'}">Content</option>
                <option value="w" th:selected="${pageRequestDTO.type=='w'}">Writer</option>
                <option value="tc" th:selected="${pageRequestDTO.type=='tc'}">Title-Content</option>
                <option value="tcw" th:selected="${pageRequestDTO.type=='tcw'}">Title-Content-Writer</option>
            </select>
        </div>
            <input type="text" class="form-control" id="keyword" placeholder="검색어">
            <div class="input-group-append">
                <button class="btn btn-outline-secondary searchBtn" type="submit">Search</button>
                <button class="btn btn-outline-secondary clearBtn" type="button">Clear</button>
            </div>
        </div>
        </form>

        <div class="card">
            <div class="card-body">
                <h5 class="card-title">List Page</h5>
                <table class="table">
                    <thead>
                    <tr>
                        <th scope="col">Bno</th>
                        <th scope="col">Title</th>
                        <th scope="col">Writer</th>
                        <th scope="col">RegDate</th>
                        <th scope="col">VisitCount</th>
                    </tr>
                    </thead>
                    <tbody th:with="link=${pageRequestDTO.getLink()}">
                    <tr th:each="dto:${responseDTO.dtoList}">
                        <th scope="row">[[${dto.bno}]]</th> <!-- th:text="${dto.bno}" 로도 사용가능 -->
                        <td><a th:href="|@{/board/read(bno=${dto.bno})}&${link}|">[[${dto.title}]]</a></td>
                        <!--() 안에 parameter -->
                        <td>[[${dto.writer}]]</td>
                        <td>[[${dto.regDate}]]</td>
                        <td>[[${dto.visitcount}]]</td>
                    </tr>
                    </tbody>
                </table>

                <div class="float-end">
                    <ul class="pagination flex-wrap">
                        <li class="page-item" th:if="${responseDTO.prev}">
                            <a class="page-link" th:data-num="${responseDTO.start -1}">Previous</a>
                        </li>
                        <th:block th:each="i: ${#numbers.sequence(responseDTO.start, responseDTO.end)}">
                            <li th:class="${responseDTO.page == i}?'page-item active':'page-item'" >
                                <a class="page-link"  th:data-num="${i}">[[${i}]]</a>
                            </li>
                        </th:block>
                        <li class="page-item" th:if="${responseDTO.next}">
                            <a class="page-link"  th:data-num="${responseDTO.end + 1}">Next</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
</div>
<script layout:fragment="script" th:inline="javascript">
    document.querySelector(".pagination").addEventListener("click", function (e){
        e.preventDefault()
        e.stopPropagation()
        const target=e.target
        if(target.tagName !=='A'){
            return;
        }
        const num=target.getAttribute('data-num');
        const formObj=document.querySelector("form");
        formObj.innerHTML += `<input type=h'hidden' name='page' value='${num}'>`
        formObj.submit()
    })
</script>
</html>